# Spree Avatax (Avalara) Official extension

[![Build Status](https://travis-ci.com/spark-solutions/spree_avatax_official.svg?token=svVk6tYzmvo9CARDPUra&branch=master)](https://travis-ci.com/spark-solutions/spree_avatax_official)

The only officially supported Avatax (Avalara) extension for [Spree Commerce](https://spreecommerce.org/) using [Avalara REST API v2](https://developer.avalara.com/api-reference/avatax/rest/v2/).

## Features

1. Tax calculation (additional/included tax), US state tax, Canadian HST, VAT supported

2. Address validation for US & Canada

3. Commiting complete orders

4. Cancelling (voiding) orders

5. Refunding orders

6. GetByCodeService for getting SalesInvoice for order from Avatax

7. GetTaxService for getting totalTaxCalculated for order from Avatax

8. AvataxLog for logging API calls

9. Caching responses for improved performance

10. Multiple company (store) support

&nbsp;

Developed and maintained by:

[![Spark Solutions](http://sparksolutions.co/wp-content/uploads/2015/01/logo-ss-tr-221x100.png)][spark]

## Installation

1. Add this extension to your `Gemfile` with this line:
  ```ruby
  gem 'spree_avatax_official', github: 'spree-contrib/spree_avatax_official'
  ```

2. Install the gem using Bundler:

  ```bash
  bundle install
  ```

3. Run the install generator

  ```bash
  bundle exec rails g spree_avatax_official:install
  ```

4. Fill up config located in `config/initializers/spree_avatax_official.rb`

5. Restart your server

  If your server was running, restart it so that it can find the assets properly.

## Setup

In order to use `spree_avatax_official` extension, you need to configure your
Avatax credentials. To do so, open spree admin panel and go to **Configurations**
and then **Avatax Settings**. Company code, account number and license key can be
configured in the **Avatax Credentials** section of the form.

<img width="1053" alt="Zrzut ekranu 2019-10-15 o 12 46 14" src="https://user-images.githubusercontent.com/581569/66825661-fcd5d000-ef4a-11e9-84b1-993b1a5c1996.png">

Edit **Tax Categories** configuration settings. If left blank, the **Tax Code** will
default to `P0000000`. The **Tax Code** must be matched to a value that is
configured in the Avalara site.

<img width="1053" alt="Zrzut ekranu 2019-10-15 o 12 51 04" src="https://user-images.githubusercontent.com/581569/66825678-095a2880-ef4b-11e9-840c-0a86dbc721b4.png">

## Migrating from spree_avatax_certified

1. Remove the `spree_avatax_certified` from your `Gemfile`
2. ...

## Testing

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

```shell
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories.
Simply add this require statement to your spec_helper:

```ruby
require 'spree_avatax_official/factories'
```

## Contributing

If you'd like to contribute, please take a look at the
[instructions](CONTRIBUTING.md) for installing dependencies and crafting a good
pull request.

## License

Spree Avatax Official is copyright Â© 2019 [Spark Solutions Sp. z o.o.][spark].
It is free software, and may be redistributed under the terms specified in the
[LICENCE](LICENSE) file.

[LICENSE]: https://github.com/spree-contrib/spree_avatax_official/blob/master/LICENSE

## About Spark Solutions

[![Spark Solutions](http://sparksolutions.co/wp-content/uploads/2015/01/logo-ss-tr-221x100.png)][spark]

Spree Avatax Official is maintained by [Spark Solutions Sp. z o.o.](http://sparksolutions.co?utm_source=github) and
funded by [Avalara Inc.](https://www.avalara.com/us/en/index.html). The names and logos are trademarks of Avalara Inc.

We are passionate about open source software.
We are [available for hire][spark].

[spark]:http://sparksolutions.co?utm_source=github
